---
title: "Soccer_stats_project"
output:
  html_document: default
Author: Rufat Aghagasimov
---

## Part 1. Introduction

**Scenario**

Coaches that are members of The Association of Modern Football Coaches (AMFC) have many good forwards. These forwards play critical roles in the success of their teams. But they do not score too many goals. So the radical fans in social media continue to bully these players. As a result the forwards are losing their confidence. 

The purpose of this project is to study statistics of top forwards that have scored at least 50 goals for national teams in international football caps. The project will analyze the changes in dynamics of goal scoring over history.  These statistics gives the measurable and objective parameters that help the AMFC members understand the full picture of goal scoring and help them to motivate their players or produce some changes. 

## Part 2. Problem

**Business task**: What changes have occurred in goal scoring process and what are modern indicators of success of forwards.

**Key stakeholders**: The Association of Modern Football Coaches (AMFC) analysts and coach staff 

## Part 3. Solution 

**Data Source**

The dataset used for this project is uploaded from Kaggle. The original name of the dataset is '50+ Football's All-Time International Goal Scorers'. The dataset was created by Kamran Ali and licensed under CC BY-SA 3.0. The dataset contains information about men football players who scored 50+ goals during their careers for national football teams. Dataset has been provided as .csv file. Dataset was last updated in December 2024. 

**The Data Manipulation and Cleaning Process**

1. Uploading key packages for analysis 

```{r}
install.packages('tidyverse')
library(tidyverse)
```

2. Then I upload the dataset and look through it 

```{r}
soccer <- data.frame(read_csv('goalscorers.csv'))
head(soccer)
```

Kaggle provided this dataset the maximum number of points (10) for usability. But I additionally rechecked the dataset for duplicates, outliers or blank fields. 

3. Then I create additional data frame 'soccer1' in order to backup and protect the original dataset from potential mistakes during the data cleaning and manipulation process

```{r}
soccer1 <- soccer
```

4. Our dataset contains 9 columns and 82 rows. The list of columns is demonstrated below 

```{r}
colnames(soccer1)
```

5. During viewing the dataset I found some moments that should be improved or corrected for the further analysis. 

6. 'Nation' column of our dataset starts with the symbol '\xa0' (Non-Breaking Space)

```{r}
select(soccer1, Nation)
```
To remove non-breaking space I used the following code chunk

```{r}
soccer1 <- soccer1 %>% 
  mutate(Player_nation = str_replace_all(Nation, '\xa0', ''))
```

To recheck that our code is running smoothly we need to look through our new 'Player_nation' column

```{r}
select(soccer1, Player_nation)
```
Always is correct. Move on

7. The next column we need to work on is a 'Career.span' column. 

```{r}
select(soccer1, Career.span)
```

First, we need to separate 'Career.span' column into career_start and career_end columns. Because after this move we can calculate the career duration and other metrics for each football player

```{r}
soccer1 <- separate(soccer1, 'Career.span', into = c('career_start', 'career_end'), sep = '-')
```

Second, our 'career_start' and 'career_end' columns contain data elements of character type. We need to convert them to integer to be able to make calculations with them

```{r}
soccer1$career_start <- as.integer(soccer1$career_start)
soccer1$career_end <- as.integer(soccer1$career_end)
```


Third, if we look through 'career_end' we can see that some rows are empty

This occurred because some football players (such as Cristiano Ronaldo or Lionel Messi) did not finish their career. In this situation we need to replace this empty cells with '2025' 

```{r}
soccer1 <- replace_na(soccer1, list (career_end = 2025))
```

To recheck that our code is running smoothly we need to look through our new 'career_end' column again

```{r}
select(soccer1, career_end)
```
Finally, we need to calculate career duration for each specific football player

```{r}
soccer1 <- mutate(soccer1, career_length = career_end - career_start)
```

To recheck that our code is running smoothly we need to look through our new 'career_length' column 

```{r}
select(soccer1, career_length)
```

Always is correct. Move on

8. We also need to pay attention to the last 'Date.of.50th.goal' column

```{r}
select(soccer1, Date.of.50th.goal)
```

We can see that our column contains data elements of character type. We need to convert them to date type. For this purpose we use dmy() function. But at first we need to upload lubridate package that contains dmy() function

```{r}
library(lubridate)
soccer1$date50 <- dmy(soccer1$`Date.of.50th.goal`)
```

To recheck that our code is running smoothly we need to look through our new 'date50' column

```{r}
select(soccer1, date50)
```
For further analysis we don't need months or days, years are enough 

```{r}
soccer1$date50 <- str_sub(soccer1$date50, 1, 4)
soccer1$date50 <- as.integer(soccer1$date50)
select(soccer1, date50)
```

Always is correct. Now we calculate how much time each football player spent to score 50 goals 

```{r}
soccer1 <- mutate(soccer1, years_need = date50 - career_start)
select(soccer1, years_need)
```

When we look through new 'years_need' column we see a new problem. Our new data shows that some players spent more than 100 years to score 50 goals. This is impossible. Most humans can't even live 100 years. There are some errors

```{r}
select(soccer1, Player, career_start, Date.of.50th.goal, date50)
```

Now we can the reason why this problem occurred. 'Date.of.50th.goal' column demonstrates the data in format '26-Jun-14' (26 June of 2014). In most situations this is not so important. But there are some exceptions. For example, legendary Hungarian striker Ferenc Puskas played in the middle of the 20th century. He scored his 50th goal 24 July of 1952. But the system identify '24-Jul-52' as '2052'. We need to correct this error. For this purpose we need to run the following code

```{r}
soccer1$years_need <- ifelse(soccer1$years_need > 100, soccer1$years_need - 100, soccer1$years_need)
select(soccer1, Player, years_need)
```

Perfect. Now Ferenc Puskas spent only 7 years instead of previous 107 to score 50 goals for the national team. Legend


**Analysis**

1. After we have finished all data manipulation processes we can move to the analysis phase 

2. The main interest for us is the studying the dynamics of change 'Goals per match' 

```{r}
max(soccer1$Goals.per.match)
min(soccer1$Goals.per.match)
mean(soccer1$Goals.per.match)
```

1.42 goals per match. I suppose this figure is too unrealistic for modern football. Both Messi and Ronaldo (the best football players of 21st century has 'Goals.per.match' that equals about 0.6)

```{r}
select(soccer1, Player, Goals.per.match)
```

Maybe we need to look at 'Goals.per.match' dynamics for football players who started their career in 21 century

```{r}
modern <- filter(soccer1, career_start >= 2000) 
max(modern$Goals.per.match) 
min(modern$Goals.per.match)
mean(modern$Goals.per.match)
```

We can see that if we analyze modern football players figures that show maximum 'Goals.per.match' decreased almost by half that when we analyze all football players

```{r}
ggplot(data = soccer1) + geom_point(mapping = aes(x = career_start, y = Goals.per.match)) +labs (x = 'Career start', y = 'Goals per match', title = 'Goals per match based on career start', subtitle = 'Best international goal scorers')
```

Our assumption turned out to be correct. 'Goals per match' decreased dramatically from the 1900s years. After 1970s the maximum amount of this indicator stays around 0.75 goals per match. Nowadays in the long term even such legends as Cristiano Ronaldo and Lionel Messi can't score 1 goal per match. 

3. The next thing we want to know the dynamics of change of the 'career_length' and 'years_need' (to score 50+ goals). The next two graphs show the career length and years need to score 50 goals for each football player based on career start date

```{r}
ggplot(data = soccer1) +geom_point(mapping = aes(x = career_start, y = career_length)) + labs(x = 'Career start', y = 'Career_length', title = 'Career length based on career start', subtitle = 'Best international goal scorers')
```

```{r}
ggplot(data = soccer1) + geom_point(mapping = aes(x = career_start, y = years_need)) + labs(x = 'Career start', y = "Years need to score 50 goals", title = 'Years need to score 50 goals based on career start', subtitle = 'Best international goal scorers')
```

At first glance we don't see any significant differences in career_length or years need to score 50 goals. Both football players who started their career before 2000 and football players who started their career after 2000 have long football career (20 years and above) and short career (less than 10 years). As well as among representatives of both groups there are football players who spent less years (9 or less) and more years (12 and above) to score 50 goals. 

If we look at more specific numbers, our conclusion will not change

```{r}
max(modern$career_length)
min(modern$career_length)
mean(modern$career_length)
```

During our analysis we have already created 'modern' data frame that contain football players whose career started in 2000 and above. We used this data frame to calculate maximum, minimum and average career length for footballers who started their career in 21st century. Now we create 'before' data frame that contains football players who started their career before 2000. After this we calculate the same figures for football players who played in 20th century 

```{r}
before <- filter(soccer1, career_start < 2000)
max(before$career_length)
min(before$career_length)
mean(before$career_length)
```

As we see there no dramatic changes in these figures. Football players who started their career in 21st century have a little increase in the maximum career length (22 vs 21 years) and a little more increase in the minimum career length (10 vs 8 years). The average career length is practically unchanged (approximately 14,9 vs 14,2 years)

If we analyze years need to score 50 goals we have the similar conclusions. Modern football players need a little more time to score 50 goals than their colleagues from 20th century. But this increase is not so dramatic (1-2 years). Furthermore maximum years need to score 50 goals for modern players is 16 years. While the same figure for football players in the 20th century is greater (17 years) 

```{r}
max(modern$years_need)
min(modern$years_need)
mean(modern$years_need)
```

```{r}
max(before$years_need)
min(before$years_need)
mean(before$years_need)
```

However, if we again look at the graph that demonstrates the career length for all football players we identify one interesting moment - a large concentration of football players in the 21st century

```{r}
ggplot(data = soccer1) +geom_point(mapping = aes(x = career_start, y = career_length)) + labs(x = 'Career start', y = 'Career_length', title = 'Career length based on career start', subtitle = 'Best international goal scorers')
```

```{r}
count(soccer1, career_start >= 2000)
```

As we can see from the code above number of football players who started their career in and after 2000 is 38. The number of football players who started their career before 2000 is 44. Thus during 25 years of the 21st almost the same number of football players can score 50+ goals as in the previous 100 years. Such a concentration can not be a coincidence. There must be a logical explanation for this moment

We identify that football players in the 21st show the decrease in number of goals per match. But the number of football players who started their career in the first 25 years of the 21st century and scored 50+ goals is almost identical with the number of the same football in the previous 100 years. At the same time both groups of the football players have not any dramatic changes in the career length figures. In such circumstances only one explanation is possible. Football players in the 21st century play more games during their career. 

The following graph shows the number of caps (football matches played for the national team) for each football player based on career start time. 

```{r}
ggplot(data = soccer1) + geom_point(mapping = aes(x = career_start, y = Caps)) + labs(x = 'Career start', y = 'Number of caps', title = 'The number of caps based on career start', subtitle = 'Best international goal scorers')
```

As we see from the graph football players from the 21st century concentrates in the upper right corner. But to get more specific numbers we can run the following code. Let's remember that we create 2 data frames: 'modern' data frame contains football players who started their career in the 21st century, while 'before' data frame contains players who started their career in the 20th century

```{r}
mean(modern$Caps)
mean(before$Caps)
```

Data shows that averagely football players who started their career in the 21st century play about 127 games during their career. This is 22 matches more than their colleagues from the 20th century. If we take into account that the football players from the 21st century score on average 0.5 goals per match we can calculate that these 22 matches give additional 11 goals. 11 goals is more than 20% of the final 50+ goals milestone

```{r}
mean(modern$Goals.per.match)
```

4. Finally, we need to research the football players' nation. May be playing for football teams from specific countries gives a boost to the goal scoring process. 

```{r}
country <- soccer1 %>% count(Player_nation)
country <- rename(country, Number_of_players = n)
ggplot(data = country) + geom_col(mapping = aes(x = reorder(Player_nation, -Number_of_players), y = Number_of_players, fill = Number_of_players)) + coord_flip() + scale_fill_distiller(palette = "Set1")+ labs(x = "Player_Nation", y = "Number_of_players", title = 'The Football Players Nationality')
```

As we can see belonging to a particular national team does not give any advantages in the goal scoring process. Brazil, Kuwait and Iran has the largest number of representatives (4). If we take into account that our list contains more than 80 football players this is less than 5% of all goal scorers. In total, football players from more than 50 countries were included in our list. This is on average 1-2 players per country. No significant concentration 


# Part 4. Conclusions

Summing up all of the above, we can make several important conclusions: 

1. **The main change between modern football players and their colleagues from the 20th century is the significant decrease in amount of goals scored per match** (look at the following graph)

```{r}
ggplot(data = soccer1) + geom_point(mapping = aes(x = career_start, y = Goals.per.match)) +labs (x = 'Career start', y = 'Goals per match', title = 'Goals per match based on career start', subtitle = 'Best international goal scorers')
```

Nobody from the 21st century was able to overcome the level 0.75 goals per match. The average level of goals per match for modern football players is 0.52 goals per match. While the same indicator for football players from the 20th century is about 0.7 goals per match (0.67). 

```{r}
mean(modern$Goals.per.match)
mean(before$Goals.per.match)
```

The reason for such a decline is a matter for separate research. However the decrease can not be related with the skill level of modern football players. Cristiano Ronaldo and Lionel Messi started the career in the 21st century. They also broke a significant number of football records set in the 20st century. However even their figures for goals per match stay below the level 0.75 goals per match (0.62 for Cristiano and 0.59 for Messi). İ think the main reason for this decrease is associated with the development of technologies and knowledge. Nowadays most of international teams and football clubs have their own departments of analytics. Coaching staffs can watch and analyze almost any match of potential opponents. They can use slow mode to study in detail any aspects of opponent team's game, use analytical models to find strong and weak points of a specific team or player. Additionally new technologies can help to reduce the number of goals scored with violation of the rules. VAR system (Video Assistant Referee) can help to determine offside with an accuracy of several centimeters, identify when a footballer play with his hand or any other violations. It is hard to imagine that Maradona can score his 'Hand of God' nowadays. However, **as I indicated above we need additional researches to determine the reason of decrease in the number of goals scored per match. With our data we can only state the significant drop in the number of goals per match in the 21st compared to the 20th century**

2. **Despite this during 25 years of the 21st century almost the same number of football players can score 50+ goals as in the previous 100 years**. As we noticed, the number of average goals per match decreased from 0.67 in the 20th century to 0.52 in the 21st century. The decline is more than 22% (22,4%). This is a considerable drop. Despite this the number of football players who scored 50+ goals did not decreased. On the contrary, this number continues to grow. 

```{r}
count(soccer1, career_start >= 2000)
```

As we can see from the code above the number of football players who started their career in and after 2000 is 38. The number of football players who started their career before 2000 is 44.  Such a concentration can not be a coincidence. There must be a logical explanation for this moment

3. **There is no significant change when we analyze the difference in career length**. The average career length for football players in the 21st century is 14.9 years while average career length for football players in the 20th century is 14,2 years. 

```{r}
mean(modern$career_length)
mean(before$career_length)
```

4. In this situation, there is only one possible explanation. **The football players from the 21st century play  more games during their career rather than their colleagues from the 20th century**. 

```{r}
mean(modern$Caps)
mean(before$Caps)
```

Data shows that averagely football players who started their career in the 21st century play about 127 games during their career. This is 22 matches more than their colleagues from the 20th century. If we take into account that the football players from the 21st century score on average 0.5 goals per match we can calculate that these 22 matches give additional 11 goals. 11 goals is more than 20% of the final 50 goals milestone. **The increase in the number of matches is not a surprise. FIFA continues its politics of increasing the number of matches to expand the number of participants and generate more profits**. For example, 24 teams took part in the 1994 FIFA World Cup. This was the last World Cup when the number of participant was 24. After this the number of participants was increased to 32. Naturally, the number of matches increased from 52 to 64. This process continues. In the 2026 World Cup the number of participants will increase to 48. The number of scheduled matches will exceed 100. 

5. **Belonging to a particular national team does not give any advantages in the goal scoring process**

# Part 5. Next Steps 

Finally we can give some recommendations: 

1. The increase in the number of matches allows modern players to compensate the drop in the number of goals scored per match. 
2. In this situations the main tasks standing in front of the football players are to demonstrate the high level of play and take care of their health to avoid injures and missed matches. 
3. The main task of coaches is to regulate the physical load to reduce the possible number of injuries. The coaches need to motivate their players to continue to perform at a high level even without scoring goals. In this context, the example of Olivier Giroud is noteworthy. Giroud is the best goal scorer played for the national team of France. He scored 57 goals for the national team. Interesting point is that he did not score any goals during the 2018 FIFA World Cup. He was the main center forward of the French national football team during the 2018 World Cup. France became the World football champion. Giroud played in all 7 matches including the final. Despite this, Giroud did not score any goals. However he did a great job on the pitch. That's why the coach continued to use him even despite the lack of goals. **Sometimes football isn't just about scoring goals!**


